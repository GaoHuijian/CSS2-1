<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="zh-CN">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<title>视觉格式化模型详细描述</title>
<link rel="stylesheet" href="style/default.css" type="text/css">
<link rel="stylesheet" href="style/W3C-REC.css" type="text/css">
<link rel="prev" href="visuren.html">
<link rel="next" href="visufx.html">
<link rel="contents" href="cover.html#minitoc">
<link rel="CSS-properties" href="propidx.html" title="properties">
<link rel="index" href="indexlist.html" title="index">
<link rel="first" href="cover.html">

<style type="text/css">
.current,.proposed,span.delcurrent,div.delcurrent { background:#feb }
ins.proposed,span.insproposed,li.insproposed,div.insproposed { background:#bfb }
del.proposed,span.delproposed { background:#fbb }
span.insproposed,li.insproposed,div.insproposed { text-decoration:underline }
span.delproposed,span.delcurrent,div.delcurrent { text-decoration:line-through }
body>del,body>ins {display:block}
</style>
</head>
<body>
<div class="navbar">
<p><a href="visuren.html">上一章</a> &nbsp;
<a href="visufx.html">下一章</a> &nbsp;
<a href="cover.html#minitoc">内容</a> &nbsp;
<a href="propidx.html">属性</a> &nbsp;
<a href="indexlist.html">索引</a> &nbsp;
</div>
<hr class="navbar">

<h1><a name="q0">10 视觉格式化模型详细描述</a></h1>
<div class="subtoc">
<p><strong>内容</strong>
  <ul class="toc">
    <li class="tocline2"><a href="visudet.html#containing-block-details" class="tocxref">10.1 “包含块”的定义</a>
    <li class="tocline2"><a href="visudet.html#the-width-property" class="tocxref">10.2 内容宽度：<span class="propinst-width">'width'</span>属性</a>
    <li class="tocline2"><a href="visudet.html#Computing_widths_and_margins" class="tocxref">10.3 计算width与margin</a>
    <ul class="toc">
      <li class="tocline3"><a href="visudet.html#inline-width" class="tocxref">10.3.1 行内非替换（non-replaced）元素</a>
      <li class="tocline3"><a href="visudet.html#inline-replaced-width" class="tocxref">10.3.2 行内替换元素</a>
      <li class="tocline3"><a href="visudet.html#blockwidth" class="tocxref">10.3.3 常规流中的块级非替换元素</a>
      <li class="tocline3"><a href="visudet.html#block-replaced-width" class="tocxref">10.3.4 常规流中的块级替换元素</a>
      <li class="tocline3"><a href="visudet.html#float-width" class="tocxref">10.3.5 浮动的非替换元素</a>
      <li class="tocline3"><a href="visudet.html#float-replaced-width" class="tocxref">10.3.6 浮动的替换元素</a>
      <li class="tocline3"><a href="visudet.html#abs-non-replaced-width" class="tocxref">10.3.7 绝对定位的非替换元素</a>
      <li class="tocline3"><a href="visudet.html#abs-replaced-width" class="tocxref">10.3.8 绝对定位的替换元素</a>
      <li class="tocline3"><a href="visudet.html#inlineblock-width" class="tocxref">10.3.9 常规流中非替换的inline-block元素</a>
      <li class="tocline3"><a href="visudet.html#inlineblock-replaced-width" class="tocxref">10.3.10 常规流中替换的inline-block元素</a>
    </ul>
    <li class="tocline2"><a href="visudet.html#min-max-widths" class="tocxref">10.4 最小、最大宽度：<span class="propinst-min-width">'min-width'</span>与<span class="propinst-max-width">'max-width'</span></a>
    <li class="tocline2"><a href="visudet.html#the-height-property" class="tocxref">10.5 内容高度：<span class="propinst-height">'height'</span>属性</a>
    <li class="tocline2"><a href="visudet.html#Computing_heights_and_margins" class="tocxref">10.6 计算height与margin</a>
    <ul class="toc">
      <li class="tocline3"><a href="visudet.html#inline-non-replaced" class="tocxref">10.6.1 行内非替换元素</a>
      <li class="tocline3"><a href="visudet.html#inline-replaced-height" class="tocxref">10.6.2 常规流中的行内替换元素，块级替换元素，替换的inline-block元素和浮动替换元素</a>
      <li class="tocline3"><a href="visudet.html#normal-block" class="tocxref">10.6.3 当'overflow'计算值为'visible'时常规流中的块级非替换元素</a>
      <li class="tocline3"><a href="visudet.html#abs-non-replaced-height" class="tocxref">10.6.4 绝对定位的非替换元素</a>
      <li class="tocline3"><a href="visudet.html#abs-replaced-height" class="tocxref">10.6.5 绝对定位的替换元素</a>
      <li class="tocline3"><a href="visudet.html#block-root-margin" class="tocxref">10.6.6 复杂情况</a>
      <li class="tocline3"><a href="visudet.html#root-height" class="tocxref">10.6.7 块格式化上下文中的'Auto'高度</a>
    </ul>
    <li class="tocline2"><a href="visudet.html#min-max-heights" class="tocxref">10.7 最小、最大高度：<span class="propinst-min-height">'min-height'</span>与<span class="propinst-max-height">'max-height'</span></a>
    <li class="tocline2"><a href="visudet.html#line-height" class="tocxref">10.8 行高的计算：<span class="propinst-line-height">'line-height'</span>与<span class="propinst-vertical-align">'vertical-align'</span>属性</a>
    <ul class="toc">
      <li class="tocline3"><a href="visudet.html#leading" class="tocxref">10.8.1 行距（Leading）与半行距</a>
    </ul>
  </ul>
</div>

<h2>10.1 <a name="containing-block-details">“包含块”的定义</a></h2>

<p>元素（生成的）盒的位置和大小有时是根据一个特定矩形计算的，叫做该元素的<dfn><a name="x0"><span
class="index-def" title="containing block">包含块（containing block）</span></a></dfn>。元素的包含块的定义如下：</p>

<ol>
<li><a href="conform.html#root">根元素</a>所在的包含块是一个被称为<dfn><a name="x1"><span class="index-def" title="initial containing block|containing block::initial">初始包含块</span></a></dfn>的矩形。对于连续媒体，尺寸取自<a href="visuren.html#viewport">视口</a>的尺寸，并且被固定在画布开始的位置；对于分页媒体就是<a href="page.html#page-area">页区（page area）</a>。初始包含块的'direction'属性与根元素的相同
</li>
<li>对于其它元素，如果该元素的position是'relative'或者'static'，包含块由其最近的<a href="visuren.html#block-boxes">块容器</a>祖先盒的content边形成
</li>
<li>如果元素具有'position: fixed'，包含块由连续媒体的<a href="visuren.html#viewport">视口</a>或者分页媒体的页区建立
</li>
<li>如果元素具有'position: absolute'，包含块由最近的<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>为'absolute'，'relative'或者'fixed'的祖先建立，按照如下方式：
<ol>
<li>如果该祖先是一个行内元素，包含块就是环绕着为该元素生成的第一个和最后一个行内框的padding box的边界框（bounding box）。在CSS&nbsp;2.1中，如果该行内元素被跨行分割了，那么包含块是未定义的
</li>
<li>否则，包含块由该祖先的<a href="box.html#padding-edge">padding边</a>形成
</li>
</ol>

<p>如果没有这样的祖先，包含块就是初始包含块
</p>
</li>
</ol>

<p>分页媒体中，一个绝对定位的元素是相对于其包含块定位的，忽略所有页结束符（就像文档是连续的一样），该元素随后可能被拆分到多页
</p>

<p>对于绝对定位的内容，如果被解析到一个除元素所在的页面（当前页面）之外的其它页面上的位置，或者是当前页上已经为打印渲染好了的位置，打印机可能把该内容放在
<ul>
<li>当前页上的另一个位置
<li>后续页，或者
<li>可能直接省略它
</ul>

<p class="note">注意，一个被跨行分割的块级元素可能在每一页上的宽度都不同，还可能存在设备特定的（device-specific）限制
</p>

<div class="example"><P style="display:none">示例：</P>
<p>不指定position的话，如下文档</p>

<pre class="html-example">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
   &lt;HEAD&gt;
      &lt;TITLE&gt;Illustration of containing blocks&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY id="body"&gt;
      &lt;DIV id="div1"&gt;
      &lt;P id="p1"&gt;This is text in the first paragraph...&lt;/P&gt;
      &lt;P id="p2"&gt;This is text &lt;EM id="em1"&gt; in the
      &lt;STRONG id="strong1"&gt;second&lt;/STRONG&gt; paragraph.&lt;/EM&gt;&lt;/P&gt;
      &lt;/DIV&gt;
   &lt;/BODY&gt;
&lt;/HTML&gt;
</pre>

<p>建立的包含块（C.B.）如下：</p>

<table border="1">
<tr><th>For box generated by </th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>body</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>p2</td></tr>
<tr><td>strong1</td><td>p2</td></tr>
</table>

<p>如果我们对"div1"定位：</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
</pre>

<p>它的包含块就不再是"body"了，变成了初始包含块（因为没有其它定位的祖先盒了）
</p>
<p>如果我们也对"em1"定位：</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
   #em1  { position: absolute; left: 100px; top: 100px }
</pre>

<p>包含块表变成了：</p>

<table border="1">
<tr><th>For box generated by</th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>initial C.B.</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>div1</td></tr>
<tr><td>strong1</td><td>em1</td></tr>
</table>

<p>对"em1"定位后，它的包含块变成了最近的定位的祖先盒（即，由"div1"生成的）
</p>
</div>


<h2>10.2 <a name="the-width-property">内容宽度</a>：<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>属性</h2>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'width'"><a name="propdef-width" class="propdef-title"><strong>'width'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>auto
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格行和行组（row group） 外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>参照包含块的宽度
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>与指定值相同的百分比或者'auto'，或者绝对长度
</table>
</dl>
</div>


<p>该属性指定了盒的<a href="box.html#content-width">内容宽度（content width）</a>
</p>
<p>该属性不适用于非替换的<a href="visuren.html#inline-boxes">行内</a>元素。非替换的行内元素盒的内容宽度是它里面渲染的内容（的内容宽度）（在所有子级的相对偏移<em>之前</em>）。请记住行内框排列在<a href="visuren.html#line-box">行框</a>里面。行框的宽度由它们的<a href="visuren.html#containing-block">包含块</a>决定，但可能因为<a href="visuren.html#floats">浮动</a>的出现而被缩短
</p>
<p>属性值含义如下：</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x4" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>用一个长度单位指定内容区（content area）的宽度
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x5" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>指定一个百分比宽度。该百分比根据生成的盒的<a href="visuren.html#containing-block">包含块</a>的宽度来计算。如果包含块的宽度取决于该元素的宽度，那么产生的布局在CSS 2.1中是未定义的<span class="note">注意：对于那些包含块基于一个块容器元素的绝对定位的元素，百分比是根据这个元素的<em>padding box</em>的宽度计算的。这与CSS1不同，（CSS1中）百分比宽度总是根据父级元素的<em>content box</em>计算的
</span>
</dd>
<dt><strong>auto</strong>
</dt>
<dd>宽度取决于其它属性的值，见下面的章节
</dd>
</dl>

<p>负值对于<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>是非法的
</p>
<div class="example"><P style="display:none">示例：</P><p>
例如，如下规则设置了段落的内容宽度为固定的100像素：</p>

<pre>
p { width: 100px }
</pre>
</div>

<h2>10.3 <a name="Computing_widths_and_margins">计算width与margin</a></h2>

<p>一个元素的<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>，<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>，<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>，<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>和<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>属性用于布局的值，取决于生成盒的类型以及相互影响（用于布局的值有时被称为<a href="cascade.html#usedValue">应用值</a>）。原则上，应用值就是把计算值'auto'替换成一些合适的值，把百分比根据包含块计算出来，但存在例外。以下情况需要加以区分：</p>

    <ol>
      <li>行内非替换元素</li>
      <li>行内替换元素</li>
      <li>常规流中的块级非替换元素</li>
      <li>常规流中的块级替换元素</li>
      <li>浮动的非替换元素</li>
      <li>浮动的替换元素</li>
      <li>绝对定位的非替换元素</li>
      <li>绝对定位的替换元素</li>
      <li>常规流中非替换的'inline-block'元素</li>
      <li>常规流中替换的'inline-block'元素</li>
    </ol>

<p>对于1-6和9-10条，相对定位的元素的'left'和'right'的值由<a href="visuren.html#relative-positioning">9.4.3节</a>中的规则确定
</p>

<p class=note><em><strong>注意</strong> 下面要计算的'width'的应用值只是一个暂定的，可能不得不计算很多次，取决于<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>和<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>，见下面的<a href="#min-max-widths">最小、最大宽度</a>章节</em>

<h3>10.3.1 <a name="inline-width">行内非替换（non-replaced）元素</a></h3>

<p><a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>属性不适用。计算值为'auto'的<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>对应的应用值为'0'
</p>

<h3>10.3.2 <a name="inline-replaced-width">行内替换元素</a></h3>

<p>计算值为'auto'的<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>对应的应用值为'0'

<p>如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>和<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>计算值都是'auto'，并且该元素还具有内在宽度，那么这个内在宽度就是<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值

<p>如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>和<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值都是'auto'，并且该元素没有内在宽度，但具有内在高度和内在比例；或者如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值为'auto'，<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>具有其它计算值，并且该元素有内在比例；那么<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值为：

<blockquote><p>(高度的应用值) * (内在比例)</blockquote>

<p>如果'height'和<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值都是'auto'，并且该元素具有内在比例但没有内在高度或者宽度，那么'width'的应用值在CSS&nbsp;2.1是未定义的。然而，建议如果包含块的宽度不依赖替换元素的宽度，那么'width'的应用值根据用于常规流中块级非替换元素的约束等式（constraint equation）来计算

<p>否则，如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值为'auto'，并且该元素具有内在宽度，那么这个内在宽度就是<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值

<p>否则，如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值为'auto'，但不满足上面的条件，那么<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值变为300px。如果300px对于适应设备来说太宽了，UA应该应用适应设备的最大的比例为2:1的矩形代替


<h3>10.3.3 <a name="blockwidth">常规流中的块级非替换元素</a></h3>

<p>其它属性的应用值，必须保证如下<a name="width-constraints">约束</a>：</p>
<blockquote>
<p><a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> + <a href="box.html#propdef-border-left-width" class="noxref"><span class="propinst-border-left-width">'border-left-width'</span></a> + <a href="box.html#propdef-padding-left" class="noxref"><span class="propinst-padding-left">'padding-left'</span></a> + <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> + <a href="box.html#propdef-padding-right" class="noxref"><span class="propinst-padding-right">'padding-right'</span></a> + <a href="box.html#propdef-border-right-width" class="noxref"><span
class="propinst-border-right-width">'border-right-width'</span></a> + <a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a> = <a href="#containing-block-details">包含块</a>的宽度
</p>
</blockquote>
 <p>如果'width'不是'auto'，并且'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width'（再加上所有不为'auto'的'margin-left'或者'margin-right'）大于包含块的宽度，那么所有'margin-left'或者'margin-right'的'auto'值在下列规则中会被当作0
</p>
<p>如果以上（属性）的计算值都不是'auto'，就说该值被过度限制（over-constrained）了，其中一个应用值将与其计算值不同。如果包含块的<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>属性值为'ltr'，<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>的指定值会被忽略，并且为了让等式成立，需要计算该值。如果<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>的值为'rtl'，就换成<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>
</p>
<p>如果有且仅有一个值被指定为'auto'，其应用值遵循等式
</p>
<p>如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>被设置为'auto'，所有其它的'auto'值都变为'0'并且<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>遵循产生的等式
</p>
<p>如果<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>和<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>都是'auto'，那么它们的应用值相等。这会让该元素相对于其包含块的边水平居中
</p>

<h3>10.3.4 <a name="block-replaced-width">常规流中的块级替换元素</a></h3>

<p><a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值由<a href="#inline-replaced-width">行内替换元素</a>决定。然后，用<a href="#blockwidth">非替换的块级元素</a>的规则来确定margin
</p>
<h3>10.3.5 <a name="float-width">浮动的非替换元素</a></h3>

<p>如果<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>的计算值为'auto'，它们的应用值为'0'
</p>
<p>如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值为'auto'，应用值为“自适应（shrink-to-fit）”宽度
</p>
<p><a name="shrink-to-fit-float"></a>自适应宽度的计算与用自动表格布局算法去算一个表格单元的宽度类似。粗略地讲：通过格式化不含除显式换行外的换行来计算首选宽度（preferred width），然后计算首选<em>最小</em>宽度（preferred minimum width），例如，通过尝试所有可能的换行。CSS&nbsp;2.1没有定义准确的算法。第三步，算出<em>可用宽度（available width）</em>：这种情况下，就是包含块的宽度减去'margin-left'，'border-left-width'，'padding-left'，'padding-right'，'border-right-width'，'margin-right'和所有相关滚动条的宽度的应用值
</p>
<p>那么自适应宽度就是：min(max(首选最小宽度, 可用宽度), 首选宽度)</p>

<h3>10.3.6 <a name="float-replaced-width">浮动的替换元素</a></h3>

<p>如果<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>的计算值为'auto'，它们的应用值为'0'。<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值由<a href="#inline-replaced-width">行内替换元素</a>决定
</p>
<h3>10.3.7 <a name="abs-non-replaced-width">绝对定位的非替换元素</a></h3>

<p>鉴于本节和后续小节的目的，术语（元素的）<a name=static-position><span class=index>“静态位置（static position）”</span></a>，粗略地讲，参考元素在常规流中的位置。更精确地：
</p>
<ul>
<li><dfn>静态位置包含块（static-position containing block）</dfn>是一个假想盒的包含块，（假想盒）将是该元素的第一个盒，它指定了<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>值为'static'并且'float'为'none'（注意，由于<a href="visuren.html#dis-pos-flo">9.7节</a>的规则，这个假想计算可能还需要给'display'假定一个不同的计算值）
</li>
<li>'left'的静态位置是从包含块的left边到作为该元素的第一个盒的假想盒的left margin边的距离，如果它的<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>属性是'static'并且<a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a>为'none'。如果假想盒在包含块的左边，那么值为负
</li>
<li>'right'的静态位置是从包含块的right边到与上面相同的假想盒的right margin边。如果假想盒在包含块边的左边，那么值为正
</li>
</ul>

<p>但不用实际计算假想盒的尺寸，用户代理可以自由猜测它可能的位置
</p>
<p>鉴于计算静态位置的目的，fixed定位的元素的包含块为初始包含块，而不是视口，并且所有可滚动的盒应该假设滚动到它们的起点

<p>决定这些元素的应用值的约束是：</p>

  <blockquote>
    <p>'left' + 'margin-left' + 'border-left-width' + 'padding-left' + 'width'
+ 'padding-right' + 'border-right-width' + 'margin-right' + 'right' = 包含块的宽度</p>
  </blockquote>

<p>如果'left'，'width'和'right'全都是'auto'：先把所有的值为'auto'的'margin-left'和'margin-right'设置为0。然后，如果建立静态位置包含块的元素的'direction'属性为'ltr'，把'left'设置为<a href="#static-position">静态位置</a>并应用下面的第3条规则；否则把'right'设置为<a href="#static-position">静态位置</a>并应用下面的第1条规则</p>

<p>如果这3个值都不是'auto'：如果'margin-left'和'margin-right'都是'auto'，解方程时要添上额外的约束：2个margin的值相等，除非这会让它们为负。如果包含块的direction是'ltr' ('rtl')，把'margin-left' ('margin-right')设置为0，再求出'margin-right' ('margin-left')。如果'margin-left'或者'margin-right'有一个是'auto'，就解方程求这个值。如果该值被过度限制了，就忽略'left'（如果包含块的'direction'属性是'rtl'）或者'right'（如果'direction'为'ltr'）的值，再求出这个值</p>

<p>否则，把值为'auto'的'margin-left'和'margin-right'设置为0，再在下面6条规则中挑1条合适的应用</p>

<ol>

<li>如果'left'和'width'都是'auto'，'right'不是'auto'，则宽度自适应，再求出'left'</li>

<li>如果'left'和'right'都是'auto'，'width'不是'auto'，如果建立静态位置包含块的元素的'direction'属性是'ltr'，就把'left'设置为<a href="#static-position">静态位置</a>，否则把'right'设置为<a href="#static-position">静态位置</a>。然后求出'left'（如果'direction'是'rtl'）或者'right'（如果'direction'是'ltr'）</li>

<li>如果'width'和'right'都是'auto'，'left'不是'auto'，则宽度自适应，再求出'right'</li>

<li>如果'left'是'auto'，'width'和'right'都不是'auto'，则求出'left'</li>

<li>如果'width'是'auto'，'left'和'right'都不是'auto'，则求出'width'</li>

<li>如果'right'是'auto'，'left'和'width'都不是'auto'，则求出'right'</li>
</ol>

<p>自适应宽度的计算与用自动表格布局算法去算一个表格单元的宽度类似。粗略地讲：通过格式化不含除显式换行外的换行来计算首选宽度（preferred width），然后计算首选<em>最小</em>宽度（preferred minimum width），例如，通过尝试所有可能的换行。CSS 2.1没有定义准确的算法。第三步，算出<em>可用宽度（available width）</em>：通过把'left'（第1种情况）或者'right'（第3种情况）设置为0后求'width'来确定</p>

<p>那么自适应宽度就是：min(max(首选最小宽度, 可用宽度), 首选宽度)</p>

<h3>10.3.8 <a name="abs-replaced-width">绝对定位的替换元素</a></h3>

<p>这种情况下，<a href="#abs-non-replaced-width">10.3.7节</a>到包括约束等式的部分都适用，但<a href="#abs-non-replaced-width">10.3.7节</a>剩余部分要用下面的规则替换掉：

<ol>
<li><a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的应用值由<a href="#inline-replaced-width">行内替换元素</a>决定。如果<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>被指定为'auto'，其应用值由下面的规则决定：
</li>
<li>如果<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>和<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>值都是'auto'，然后如果建立静态位置包含块的元素的'direction'属性为'ltr'，把<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>设置为静态位置，否则如果'direction'为'rtl'，就把<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>设置为静态位置
</li>
<li>如果<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>或者<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>为'auto'，把所有值为'auto'的<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>替换为'0'
</li>
<li>如果此时<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>和<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>仍然是'auto'，解方程时要添上额外的约束：2个margin必须相等，除非这会让它们为负。如果包含块的direction是'ltr' ('rtl')，把<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> (<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>)设置为0，再求出<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a> (<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>)
</li>
<li>如果此时只剩一个'auto'了，就解方程求出这个值
</li>
<li>如果此时该值被过度限制了，忽略<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>（包含块的<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>属性为'rtl'时）或者<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>（<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>为'ltr'时），再求出这个值
</li>
</ol>


<h3>10.3.9 <a name="inlineblock-width">常规流中非替换的inline-block元素</a></h3>

<p>如果<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>为'auto'，应用值就与浮动元素一样是<a href="#shrink-to-fit-float">自适应</a>宽度
</p>
<p>计算值为'auto'的<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>或者<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>的应用值变为'0'
</p>

<h3>10.3.10 <a name="inlineblock-replaced-width">常规流中替换的inline-block元素</a></h3>

<p>与<a href="#inline-replaced-width">行内替换元素</a>完全一致
</p>

<h2>10.4 <a name="min-max-widths">最小、最大宽度</a>：<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>与<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a></h2>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'min-width'"><a name="propdef-min-width" class="propdef-title"><strong>'min-width'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>0
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格行和行组（row group）外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>参照包含块的宽度
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>与指定值相同的百分比或者绝对长度
</table>
</dl>
</div>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'max-width'"><a name="propdef-max-width" class="propdef-title"><strong>'max-width'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>none
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格行和行组（row group）外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>参照包含块的宽度
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>与指定值相同的百分比或者绝对长度或者'none'
</table>
</dl>
</div>


<p>这两个属性允许编写者把内容宽度约束到一个特定范围。值含义如下：</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x8" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>指定一个固定的最小或者最大应用宽度
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x9" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>指定一个用来确定应用值的百分比。百分比参照生成盒的<a href="visuren.html#containing-block">包含块</a>的宽度来计算。如果包含块的宽度为负，那么应用值为0。如果包含块的宽度取决于该元素的宽度，那么产生的布局在CSS 2.1中是未定义的
</dd>
<dt><strong>none</strong>
</dt>
<dd>（只对<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>有效）对盒的宽度没有限制
</dd>
</dl>

<p>负值对<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>和<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>是非法的
</p>

<p>CSS&nbsp;2.1中，'min-width'和'max-width'对表格，行内表格，表格单元，表格列和列组（column group）的效果是未定义的

<p>下面的算法描述了这两个属性怎样影响<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>属性的<a href="cascade.html#computed-value">应用值</a>：</p>
<ol>

<li>暂定的应用宽度按照上面的<a href="#Computing_widths_and_margins">“计算width与margin”</a>来计算（不考虑<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>和<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>）
</li>
<li>如果暂定的应用值大于<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>，就再应用一遍<a href="#Computing_widths_and_margins">上面的</a>规则，但这次把<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>的计算值作为<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值
</li>
<li>如果产生的宽度小于<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>，就再应用一遍<a href="#Computing_widths_and_margins">上面的</a>规则，但这次把<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>值作为<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值
</li>
</ol>

<p class="note">这些步骤不影响上述属性真正的计算值</p>

<p>然而，对于具有内在比例并且<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>和<a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a>都被指定为'auto'的的替换元素，算法如下：
</p>

<p>从表格中的约束违反情况找出解得高度和宽度值。取<var>max-width</var>和<var>max-height</var>作为max(min, max)，以保证<var>min</var>&#8804<var>max</var>成立。表中的<var>w</var>和<var>h</var>代表忽略<a href="visudet.html#propdef-min-width" class="noxref"><span class="propinst-min-width">'min-width'</span></a>，<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>，<a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>和<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>属性后，width和height计算的结果。常规地这些都是内在宽度和高度，但它们可能不属于具有内在比例的替换元素的情况

<p class=note>注意：如果设置了一个明确的宽度或者高度，而其它尺寸为auto，对auto边应用一个最小或者最大约束会引起过度约束的情况。规范对这种行为很明确，但可能不是编写者预期的。CSS3的object-fit属性可以用来获取这种情况下不同的结果

<table rules=all>
<thead>
  <tr><th>违反的约束</th><th>解得宽度</th><th>解得高度</th></tr>
</thead>
<tbody>

  <tr><td>none</td>
      <td><var>w</var></td>
      <td><var>h</var></td></tr>
  <tr><td><var>w&nbsp;>&nbsp;max-width</var></td>
      <td><var>max-width</var></td>

      <td><var>max(max-width&nbsp;*&nbsp;h/w, min-height)</var></td></tr>
  <tr><td><var>w&nbsp;<&nbsp;min-width</var></td>
      <td><var>min-width</var></td>
      <td><var>min(min-width&nbsp;*&nbsp;h/w, max-height)</var></td></tr>

  <tr><td><var>h&nbsp;>&nbsp;max-height</var></td>
      <td><var>max(max-height&nbsp;*&nbsp;w/h, min-width)</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td><var>h&nbsp;<&nbsp;min-height</var></td>

      <td><var>min(min-height&nbsp;*&nbsp;w/h, max-width)</var></td>
      <td><var>min-height</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>), where (<var>max-width/w&nbsp;&#8804;&nbsp;max-height/h</var>)</td>

      <td><var>max-width</var></td>
      <td><var>max(min-height, max-width&nbsp;*&nbsp;h/w)</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>), where (<var>max-width/w&nbsp;>&nbsp;max-height/h</var>)</td>

      <td><var>max(min-width, max-height&nbsp;*&nbsp;w/h)</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td>(<var>w&nbsp;<&nbsp;min-width</var>) and (<var>h&nbsp;<&nbsp;min-height</var>), where (<var>min-width/w&nbsp;&#8804;&nbsp;min-height/h</var>)</td>

      <td><var>min(max-width, min-height&nbsp;*&nbsp;w/h)</var></td>
      <td><var>min-height</var></td></tr>
  <tr><td>(<var>w&nbsp;<&nbsp;min-width</var>) and (<var>h&nbsp;<&nbsp;min-height</var>), where (<var>min-width/w&nbsp;>&nbsp;min-height/h</var>)</td>

      <td><var>min-width</var></td>
      <td><var>min(max-height, min-width&nbsp;*&nbsp;h/w)</var></td></tr>
  <tr><td>(<var>w&nbsp;<&nbsp;min-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>)</td>

      <td><var>min-width</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;<&nbsp;min-height</var>)</td>

      <td><var>max-width</var></td>
      <td><var>min-height</var></td></tr>
</tbody>
</table>

<p>然后应用上面的<a href="#Computing_widths_and_margins">“计算width与margin”</a>的规则，就像<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值是该值一样





<h2>10.5 <a name="the-height-property">内容高度</a>：<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>属性</h2>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'height'"><a name="propdef-height" class="propdef-title"><strong>'height'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>auto
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格列和列组（column group）外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>见下文
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>百分比或者'auto'（见下文的<a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a>）或者绝对长度
</table>
</dl>
</div>


<p>该属性指定了盒的<a href="box.html#content-height">内容高度（content height）</a>

<p>该属性不适用于非替换的<a href="visuren.html#inline-boxes">行内</a>元素，替代规则见<a href="#inline-non-replaced">计算非替换的行内元素的height和margin</a>小节
</p>
<p>值的含义如下：</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x11" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>用一个长度值指定内容区（content area）的高度
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x12" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>指定一个百分比高度。百分比参照生成盒的<a href="visuren.html#containing-block">包含块</a>的高度。如果包含块的高度没有显式指定（即取决于内容高度），并且该元素不是绝对定位的，则计算值为'auto'。<a href="conform.html#root">根元素</a>上的百分比高度是相对于<a href="#containing-block-details">初始包含块</a>的
<span class="note">
注意：对于那些包含块基于一个块级元素的绝对定位的元素，百分比根据这个元素的<em>padding box</em>的高度来计算。这与CSS1不同，（CSS1中）百分比总是根据父级元素的<em>content box</em>来计算
</span>
</dd>
<dt><strong>auto</strong>
</dt>
<dd>高度取决于其它属性的值，见下文
</dd>
</dl>

<p class="note">注意，一个绝对定位的元素的包含块的高度独立于该元素本身的大小，因此这种元素上的百分比高度都可以解出来（can always be resolved）。然而，可能直到文档中在此之后的元素处理完毕后，才能获知该高度
</p>

<p>负值对于<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>是非法的
</p>
<div class="example"><P style="display:none">示例：</P><p>
例如，如下规则把段落的内容高度设置为100像素：</p>

<pre>
p { height: 100px }
</pre>

<p>那些内容高度超过100像素的段落将根据<a href="visufx.html#propdef-overflow" class="noxref"><span class="propinst-overflow">'overflow'</span></a>属性<a href="visufx.html#overflow">溢出</a>
</p>
</div>

<h2>10.6 <a name="Computing_heights_and_margins">计算height与margin</a></h2>

<p>对于计算<a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>，<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>，<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>，<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>和<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>的值，必须区分盒的种类：
</p>
    <ol>
      <li>行内非替换元素</li>
      <li>行内替换元素</li>
      <li>常规流中的块级非替换元素</li>
      <li>常规流中的块级替换元素</li>
      <li>浮动的非替换元素</li>
      <li>浮动的替换元素</li>
      <li>绝对定位的非替换元素</li>
      <li>绝对定位的替换元素</li>
      <li>常规流中非替换的'inline-block'元素</li>
      <li>常规流中替换的'inline-block'元素</li>
    </ol>

<p>对于1-6和9-10条，'top'和'bottom'的应用值由9.4.3节的规则确定
</p>

<p class=note>注意：这些规则同样适用于根元素，和其它元素一样

<p class=note><em><strong>注意</strong> 下面计算的'height'的应用值是一个暂定值，可能不得不计算很多次，取决于<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>和<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>，见下面的<a href="#min-max-heights">最小、最大高度</a>章节</em>

<h3>10.6.1 <a name="inline-non-replaced">行内非替换元素</a></h3>

<p><a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>属性不适用。内容区（content area）的高度应该基于字体，但本规范没有具体说明。例如，UA可以使用em盒（em-box）或者字体的最大上伸部（ascender）和下伸部（descender）（后者能够确保em盒上方或者下方的字形（glyph）仍处于内容区里，但会导致不同字体有不同大小的盒；前者能够确保编写者可以相对于'line-height'控制背景样式化，但会导致字形绘制在其内容区外）
</p>
<p class=note>注意：CSS 3可能会含有用来选择用于内容高度的字体测量方法的属性
</p>
<p>一个行内非替换盒的垂直padding，border和margin从内容区的top和bottom开始，并且与<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>无关。<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>只用在计算行框的高度时使用
</p>
<p><a name="multi-font-inline-height"></a>如果应用了多个字体（发现字形是多种字体时会发生这种情况），内容区的高度不由本规范定义。然而，我们建议高度让内容区刚好放得下元素中的<em>所有</em>字体的(1)em盒或者(2)最大上伸部和下伸部。注意，这可能大于所有涉及的字体（的高度），取决于字体的基线对齐方式
</p>

<h3>10.6.2 <a name="inline-replaced-height">常规流中的行内替换元素，块级替换元素，替换的inline-block元素和浮动替换元素</a></h3>

<p>如果<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>或者<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>为'auto'，其应用值为0

<p>如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>和<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>的计算值都是'auto'，并且元素还具有内在高度，那么这个内在高度就是<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的应用值

<p>否则，如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值为'auto'，并且该元素具有内在比例，那么<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的应用值为：

<blockquote><p>(宽度的应用值) / (内在比例)</blockquote>

<p>否则，如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值为'auto'，并且该元素具有内在高度，那么这个内在高度就是<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的应用值

<p>否则，如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值为'auto'，但上面的条件都不满足，那么<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的应用值必须设置为比例为2:1，高度不超过150px并且宽度不超过设备宽度的最大矩形的高度





<h3>10.6.3 <a name="normal-block">当'overflow'计算值为'visible'时常规流中的块级非替换元素</a></h3>

<p>当'overflow'的计算值不为'visible'但已经传播到视口时，本节也适用于常规流中的块级非替换元素

<p>如果<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>或者<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>为'auto'，其应用值为0。如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>为'auto'，高度取决于该元素是否具有任意块级子级和是否具有padding或者border：
</p>

<p>该元素的高度为从其top content边到下面第一个适用的（位置）的距离：

<ol>
  <li>最后一个行框的bottom边。如果该盒为一行或多行建立了一个行内格式化上下文的话

  <li>它的最后一个流内子级的bottom margin（可能被合并了）的的bottom边。如果该子级的bottom margin没有和该元素的bottom margin合并的话

  <li>最后一个top margin没有和该元素的bottom margin合并的流内子级的bottom border边

  <li>否则，为0
</ol>

<p>只考虑常规流中的子级（即，浮动盒和绝对定位的盒会被忽略，并且相对定位的盒不考虑其偏移）。注意子级盒可以是一个<a href="visuren.html#anonymous-block-level">匿名块盒</a>
</p>

<h3>10.6.4 <a name="abs-non-replaced-height">绝对定位的非替换元素</a></h3>

<p>鉴于本节和下一节的目的，术语（一个元素的）"static position"，粗略地讲，参考元素在常规流中的位置。更精确地，'top'的静态位置是从包含块的top边到假想盒的top margin边的距离，假想盒是该元素的第一个指定了<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>值为'static'，<a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a>为'none'并且<a href="visuren.html#propdef-clear" class="noxref"><span class="propinst-clear">'clear'</span></a>为'none'的盒（注意，由于<a href="visuren.html#dis-pos-flo">9.7节</a>中的规则，可能还需要为'display'假定一个不同的计算值）。如果假想盒在包含块上方，该值为负
</p>
<p>但不用实际计算这个假想盒的尺寸，用户代理可以自由猜测它可能的位置
</p>
<p>鉴于计算静态位置的目的，fixed定位元素的包含块是初始包含块而不是视口

<p>对于绝对定位的元素，垂直方向（dimension）的应用值必须满足这样的约束：</p>

  <blockquote>
    <p>'top' + 'margin-top' + 'border-top-width' + 'padding-top' +      'height'
+ 'padding-bottom' + 'border-bottom-width' +      'margin-bottom' + 'bottom'
= 包含块的高度</p>
  </blockquote>

<p>如果'top'，'height'和'bottom'都是auto，把'top'设置为静态位置并应用下面的第3条规则：</p>

<p>如果这3个值都不是'auto'：如果'margin-top'和'margin-bottom'都是'auto'，解方程时要添上额外的约束：2个margin的值相等。如果'margin-top'或者'margin-bottom'有一个是'auto'，解方程求出这个值。如果该值被过度约束了，就忽略'bottom'的值再求这个值</p>

<p>否则，在下面6条规则中挑1条合适的应用</p>

<ol>
<li>如果'top'和'height'都是'auto'，'bottom'不是'auto'，则高度是<a href="#root-height">根据10.6.7由内容决定</a>，把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'top'

<li>如果'top'和'bottom'都是'auto'，'height'不是'auto'，则把'top'设置为静态位置，把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'bottom'</li>

<li>如果'height'和'bottom'都是'auto'，'top'不是'auto'，则高度<a href="#root-height">根据10.6.7由内容决定</a>，把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'bottom'</li>

<li>如果'top'是'auto'，'height'和'bottom'都不是'auto'，则把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'top'</li>

<li>如果'height'是'auto'，'top'和'bottom'都不是'auto'，则把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'height'</li>

<li>如果'bottom'是'auto'，'top'和'height'都不是'auto'，则把值为'auto'的'margin-top'和'margin-bottom'设置为0，再求出'bottom'</li>
</ol>

<h3>10.6.5 <a name="abs-replaced-height">绝对定位的替换元素</a></h3>

<p>这种情况与前一种类似，除了元素具有<a href="conform.html#intrinsic">内在</a>高度。步骤（sequence）替换为：
</p>
<ol>

<li><a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的应用值由<a href="#inline-replaced-height">行内替换元素</a>决定。如果'margin-top'或者'margin-bottom'被指定为'auto'，其应用值就由下面的规则决定</li>
<li>如果<a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>和<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>都是'auto'，把<a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>换成该元素的<a href="#static-position">静态位置</a>
</li>
<li>如果<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>是'auto'，把所有值为'auto'的<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>或者<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>换成'0'
</li>
<li>如果此时<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>和<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>仍然都是'auto'，解方程时要添上额外的约束：2个margin值必须相等
</li>
<li>如果此时只剩下一个'auto'了，解方程求出这个值
</li>
<li>如果此时该值被过度约束了，就忽略<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>的值再求出这个值
</li>
</ol>





<h3>10.6.6 <a name="block-root-margin">复杂情况</a></h3>

<p>本节适用于：

<ul>
    <li>常规流中的块级非替换元素，当'overflow'的计算值不为'visible'时（除了'overflow'属性的值已经传播到了视口的情况）

    <li>非替换的'inline-block'元素

    <li>浮动的非替换元素
</ul>

<p>如果<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>或者<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>为'auto'，其应用值为0。如果<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>是'auto'，<a
href="#root-height">高度取决于该元素的后代，根据10.6.7</a>

<p>对于'inline-block'元素，在计算行框的高度时，要用到margin box


<h3>10.6.7 <a name="root-height">块格式化上下文中的'Auto'高度</a></h3>

<p>特定情况下（例如，见上面的<a href="#abs-non-replaced-height">10.6.4</a>节和<a href="#block-root-margin">10.6.6</a>节），一个建立了块格式化上下文的元素的高度按照如下规则计算：

<p>如果它只含有行内级子级，高度就是最高的行框的top与最低的行框的bottom之间的距离
</p>
<p>如果它只含有块级子级，高度由就是最高的块级子级盒的top margin-edge到最低的块级子级盒的bottom margin-edge之间的距离
</p>
<p>绝对定位的子级会被忽略，而相对定位的盒不考虑其偏移。注意，子级盒可以是一个<a href="visuren.html#anonymous-block-level">匿名块盒</a>
</p>
<p>此外，如果该元素含有任意bottom margin边位于元素的content边下方的的浮动后代，那么高度增加至能够包含这些边。只考虑参与此块级格式化上下文的浮动，例如，不考虑绝对定位的后代中的浮动或者其它浮动
</p>



<h2>10.7 <a name="min-max-heights">最小、最大高度</a>：<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>与<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a></h2>

<p>有时把元素的高度约束到一个特定范围很有用。两个属性提供了这种功能：
</p>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'min-height'"><a name="propdef-min-height" class="propdef-title"><strong>'min-height'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>0
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格列和列组（column group）外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>见下文
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>与指定值相同的百分比，或者绝对长度
</table>
</dl>
</div>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'max-height'"><a name="propdef-max-height" class="propdef-title"><strong>'max-height'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>none
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>除非替换的行内元素，表格列和列组（column group）外的所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>见下文
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>与指定值相同的百分比或者绝对长度或者'none'
</table>
</dl>
</div>


<p>这两个属性允许编写者把盒的高度约束到一个特定范围。值的含义如下：</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x15" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>指定一个固定的最小或者最大计算高度（computed height）
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x16" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>指定一个用来确定应用值的百分比。百分比根据生成盒的<a href="visuren.html#containing-block">包含块</a>的高度来计算。如果包含块的高度不是显式指定的（即，取决于内容高度），并且该元素不是绝对定位的，百分比值会被当作'0'（对于<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>）或者'none'（对于<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>）
</dd>
<dt><strong>none</strong>
</dt>
<dd>（只对<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>有效）对盒的高度没有限制
</dd>
</dl>

<p>负值对<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>和<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>是非法的
</p>

<p>CSS&nbsp;2.1中，'min-height'和'max-height'对表格，行内表格，表格单元，表格行和行组（row group）的效果是未定义的

<p>如下算法描述了这两个属性怎样影响<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>属性的<a href="cascade.html#computed-value">应用值</a>：</p>

<ol>

<li>计算暂定的应用高度（不考虑<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>和<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>）遵循上面<a href="#Computing_heights_and_margins">“计算height与margin”</a>中的规则
</li>
<li>如果这个暂定高度大于<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>，就再应用一遍<a href="#Computing_heights_and_margins">上面的</a>规则，但这次把<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>的值作为<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值
</li>
<li>如果产生的高度小于<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>，就再应用一遍<a href="#Computing_heights_and_margins">上面的</a>规则，但这次把<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>的值作为<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值
</li>
</ol>

<p class="note">这些步骤不会影响上面属性真正的计算值，<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>应用值的变更不会影响margin合并，除了在<a
href="box.html#collapsing-margins">“合并margin(8.3.1)”</a>中特别提到的关于<a href="visudet.html#propdef-min-height" class="noxref"><span class="propinst-min-height">'min-height'</span></a>或者<a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>的规则</p>

<p>然而，对于<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>和<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>的计算值为'auto'的替换元素，就用上面的<a href="#min-max-widths">最小、最大宽度</a>中的算法来算出宽度和高度的应用值。然后把产生的宽度和高度作为计算值再应用上面的<a href="#Computing_heights_and_margins">“计算height与margin”</a>中的规则
</p>
<h2>10.8 <a name="line-height">行高的计算</a>：<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>与<a href="visudet.html#propdef-vertical-align" class="noxref"><span class="propinst-vertical-align">'vertical-align'</span></a>属性</h2>

<p>如<a href="visuren.html#inline-formatting">行内格式化上下文</a>节所述，用户代理把行内级盒排列在一个<a href="visuren.html#line-box">行框</a>的垂直堆叠里。行框的高度由下列规则决定：</p>

<ol>
<li>计算行框中每个行内级盒的高度时，对于替换元素，inline-block元素和inline-table元素，这个值就是其margin box的高度；对于行内框，这个值是其'line-height'（见<a href="#Computing_heights_and_margins">“计算height与margin”</a>和<a href="#leading">“行距（Leading）与半行距”</a>中的<a href="#inline-box-height">行内框的高度</a>）

</li>
<li>行内级盒是根据其<a href="visudet.html#propdef-vertical-align" class="noxref"><span class="propinst-vertical-align">'vertical-align'</span></a>属性垂直对齐的。如果它们是'top'或者'bottom'对齐，它们必须对齐得让行框高度最小化。如果这样的盒足够高，存在多个解，而CSS&nbsp;2.1没有定义行框基线的位置（即，<a href="#strut">strut</a>的位置，见下文）
</li>
<li>行框高度是最高的盒的top与最低的盒的bottom之间的距离（包括下面<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>中解释的<a href="#strut">strut</a>）
</li>
</ol>

<p>空行内元素生成空的行内框，但这些盒仍然具有margin，padding，border和line height，并因此会影响这些计算，就像有内容的元素一样
</p>

<h3>10.8.1 <a name="leading">行距（Leading）与半行距</a></h3>

<p>CSS假定任何字体都具有指定了基线上方的高度（height）和下方的深度（depth）特征的字体规格（font metrics）。本节中，我们用<var>A</var>表示高度（对于一个给定大小的指定字体），<var>D</var>表示深度。我们还定义了<var>AD</var> = <var>A</var> + <var>D</var>，表示从top到bottom的距离（见下面对<a href="#sTypoAscender">如何找出TrueType和OpenType字体的<var>A</var>和<var>D</var></a>的注释）。注意，这些都是字体整体的规格，并没有与所有单个字形的上伸部（ascender）和下伸部（descender）对应

<p>用户代理必须把一个非替换的行内框中的字形彼此之间按其相关基线对齐，然后，对每个字形，确定<var>A</var>和<var>D</var>。注意单一元素中的字形可能来自不同的字体，并且因此不一定具有相同的<var>A</var>和<var>D</var>。如果行内框不含任何字形，就认为它含有一个<a href="#strut">strut</a>（一个不可见的0宽字形），它具有该元素的第一个可用字体的<var>A</var>和<var>D</var>

<p>然后对每个字形，确定要添加的行距（leading）<var>L</var>，其中<var>L</var> = <a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a> - <var>AD</var>。半行距添在<var>A</var>上方，而另一半添在<var>D</var>下方，字形及其行距在基线上方的总高度为<var>A'</var> = <var>A</var> + <var>L</var>/2，总深度为<var>D'</var> = <var>D</var> + <var>L</var>/2

<p class=note><strong>注意</strong> <var>L</var>可以为负

<p id="inline-box-height">行内框的高度包含所有字形及其两边的半行距，所以恰好是'line-height'。子级元素的盒不会影响这个高度

<p>尽管非替换元素的margin，border和padding不会算入行框的计算，它们仍然渲染在行内框周围。这意味着如果用<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>指定的高度小于包含的盒（contained boxes）的内容高度，背景与padding和border的颜色可能会“流（bleed）”进相邻的行框。用户代理应该按文档顺序渲染这些盒。这将导致后续行的border绘制在之前行的border和文本上面（覆盖）
</p>

<p class=note><em><strong>注意</strong> CSS&nbsp;2.1没有定义一个行内框的内容区（content area）是什么（见上面的<a href="#inline-non-replaced">10.6.1</a>），并且因此不同的UA可能在不同的地方绘制背景和border</em>

<p id=sTypoAscender class=note><em><strong>注意</strong> 建议使用OpenType或者TrueType字体的实现根据字体的OS/2表中的"sTypoAscender"和"sTypoDescender"规格（metrics）找出相应的A和D（在缩放当前元素的字体大小后）。如果没有这些规格，就应该用HHEA表中的"Ascent"和"Descent"规格</em>

<div class="propdef">
<dl><dt>
<span class="index-def" title="'line-height'"><a name="propdef-line-height" class="propdef-title"><strong>'line-height'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td>normal | <a href="syndata.html#value-def-number" class="noxref"><span class="value-inst-number">&lt;number&gt;</span></a> | <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>normal
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>所有元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>yes
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>参考元素自身的字体大小
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>对于<a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a>和<a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a>是绝对的值，否则与指定值相同
</table>
</dl>
</div>


<p>对于一个内容由<a href="visuren.html#inline-level">行内级</a>元素组成的<a href="visuren.html#block-boxes">块容器元素</a>，'line-height'指定了元素内行框的<em>最小</em>高度。这个最小高度包含基线上方的最小高度和下方的最小深度，就像每个行框以一个<a name="strut">具有该元素的字体和行高属性的0宽行内框开始</a>。我们把这种假想盒叫做"strut"（这个名字是受TeX的启发）
</p>

<p>假设字体基线上方和下方的高度和深度存在于该字体所包含的规格中（更多详细信息，见CSS level&nbsp;3）

<p>对于非替换的<a href="visuren.html#inline-boxes">行内</a>元素，'line-height'指定了用来计算行框高度的高度
</p>
<p>属性值含义如下：</p>

<dl>
<dt><strong>normal</strong> </dt>
<dd>告诉用户代理根据该元素的字体把应用值设置为一个“合理的”值。该值与<span class="index-inst" title="&lt;number&gt;"><a name="x18" href="syndata.html#value-def-number" class="noxref"><span class="value-inst-number">&lt;number&gt;</span></a></span>的含义相同。我们推荐介于1.0到1.2的“常规”应用值。<a href="cascade.html#computed-value">计算值</a>为'normal'
</dd>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x19" href="syndata.html#value-def-length" class="noxref"><span
class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>指定的长度用来计算行框的高度。负值是非法的
</dd>
<dt><span class="index-inst" title="&lt;number&gt;"><a name="x20" href="syndata.html#value-def-number" class="noxref"><span
class="value-inst-number"><strong>&lt;number&gt;</strong></span></a></span>
</dt>
<dd>该属性的应用值为这个数字乘以该元素的字体大小。负值是非法的。<a href="cascade.html#computed-value">计算值</a>与指定值相同
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x21" href="syndata.html#value-def-percentage" class="noxref"><span
class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>该属性的<a href="cascade.html#computed-value">计算值</a>为这个百分比乘以该元素的字体大小的计算值。负值是非法的
</dd>
</dl>

<div class="example"><P style="display:none">示例：</P><p>
下例的这3条规则会产生相同的行高：
</p>
<pre>
div { line-height: 1.2; font-size: 10pt }     /* number */
div { line-height: 1.2em; font-size: 10pt }   /* length */
div { line-height: 120%; font-size: 10pt }    /* percentage */
</pre>
</div>

<p>当一个元素含有以多种字体渲染的文本时，用户代理可以根据最大字体大小来确定“常规”<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>值
</p>
<p class=note><em><strong>注意</strong> 当一个块容器盒里的所有行内框只有一个<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>值并且它们都是相同的字体时（并且不存在替换元素，行内元素等等），以上内容将确保连续行的基线都恰好相隔<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>。在不得不对齐字体不同的文本列时，这一点很重要，例如在一个表格中</em>
</p>
<div class="propdef">
<dl><dt>
<span class="index-def" title="'vertical-align'"><a name="propdef-vertical-align" class="propdef-title"><strong>'vertical-align'</strong></a></span>
<dd>
<table class="propinfo" cellspacing=0 cellpadding=0>
<tr valign=baseline><td><em>Value:</em>&nbsp;&nbsp;<td>baseline | sub | super | top | text-top | middle |
   bottom | text-bottom | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr valign=baseline><td><em>Initial:</em>&nbsp;&nbsp;<td>baseline
<tr valign=baseline><td><em>Applies to:</em>&nbsp;&nbsp;<td>行内级和'table-cell'元素
<tr valign=baseline><td><em>Inherited:</em>&nbsp;&nbsp;<td>no
<tr valign=baseline><td><em>Percentages:</em>&nbsp;&nbsp;<td>参照元素自身的'line-height'
<tr valign=baseline><td><em>Media:</em>&nbsp;&nbsp;<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr valign=baseline><td><em>Computed&nbsp;value:</em>&nbsp;&nbsp;<td>对于<a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a>和<a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a>，就是绝对长度，否则与指定值相同
</table>
</dl>
</div>


<p>该属性会影响由一个行内级元素生成的盒的行框内部的垂直定位</p>

<div class="note"><p>
<em><strong>注意</strong> 该属性的值在表格上下文中具有不同的含义。详细信息请查看<a href="tables.html#height-layout">表格高度算法</a>章节
</em>
</p>
</div>

<p>下列值只对父级行内元素或者一个父级块容器元素的<a href="#strut">strut</a>有效

<p>在下面的定义中，对于行内非替换元素，用于对齐的盒是那个高度为'line-height'（包括该盒的字形和两边的半行距，见<a href="#inline-box-height">上文</a>）的盒。对于其它所有元素，用于对齐的盒都是margin box

<dl>
  <dt><strong>baseline</strong></dt>
  <dd>把盒的基线与父级盒的基线对齐。如果该盒没有基线，就把bottom margin边和父级的基线对齐</dd>
  <dt><strong>middle</strong></dt>
  <dd>把该盒的垂直中点和父级盒的基线加上父级的半x-height对齐</dd>
  <dt><strong>sub</strong></dt>
  <dd>把该盒的基线降低到合适的位置作为父级盒的下标（该值不影响该元素文本的字体大小）</dd>
  <dt><strong>super</strong></dt>
  <dd>把该盒的基线提升到合适的位置作为父级盒的上标（该值不影响该元素文本的字体大小）</dd>
  <dt><strong>text-top</strong></dt>
  <dd>把该盒的top和父级的内容区（content area）的top对齐（见<a href="#inline-non-replaced">10.6.1</a>）</dd>
  <dt><strong>text-bottom</strong></dt>
  <dd>把该盒的bottom和父级的内容区的bottom对齐（见<a href="#inline-non-replaced">10.6.1</a>）</dd>
  <dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x23" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;
  </strong></span></a></span></dt>
  <dd>把该盒提升（正值）或者降低（负值）这个距离（<a href="visudet.html#propdef-line-height" class="noxref"><span class="propinst-line-height">'line-height'</span></a>值的百分比）。值'0%'表示与“基线”相同</dd>
  <dt><span class="index-inst" title="&lt;length&gt;"><a name="x24" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;
  </strong></span></a></span></dt>
  <dd>把该盒提升（正值）或者降低（负值）这个距离。值'0cm'表示与“基线”相同
  </dd>
</dl>
<p>下面的值让元素相对于一个行框对齐。因为该元素可能具有相对于它对齐的子级（相应的，（这些子级也）可能具有相对于它们对齐的后代），这些值使用对齐子树的边界（the bounds of the aligned subtree）。一个行内元素的<dfn>对齐子树</dfn>包括这个元素和所有'vertical-align'的计算值不为'top'或者'bottom'的子级行内元素的对齐子树。对齐子树的top是子树中盒的top最高的（位置），bottom（的定义）与之类似
<dl>
  <dt><strong>top</strong></dt>
  <dd>把对齐子树的top与行框的top对齐</dd>
  <dt><strong>bottom</strong></dt>
  <dd>把对齐子树的bottom与行框的bottom对齐</dd>
</dl>

<p>'inline-table'（盒）的基线是表格第一行的基线
</p>
<p>'inline-block'（盒）的基线是它的最后一个常规流中的行框的基线，除非它没有流内行框或者它的'overflow'属性的计算值不为'visible'，此时基线是bottom margin边</p>
<hr class="navbar">

<div class="navbar">
<p><a href="visuren.html">上一章</a> &nbsp;
<a href="visufx.html">下一章</a> &nbsp;
<a href="cover.html#minitoc">内容</a> &nbsp;
<a href="propidx.html">属性</a> &nbsp;
<a href="indexlist.html">索引</a> &nbsp;
</div>
</body>
</html>


